<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Likelihood &amp; Model Fit | Bayes</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-deep-space.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-deep-space.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/+esm.js">
<link rel="modulepreload" href="./_npm/arquero@5.4.0/+esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.13/+esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/+esm.js">
<link rel="modulepreload" href="./_npm/apache-arrow@14.0.2/+esm.js">
<link rel="modulepreload" href="./_npm/acorn@8.11.2/+esm.js">
<link rel="modulepreload" href="./_npm/d3@7.8.5/+esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/+esm.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/+esm.js">
<script type="module">

import {define} from "./_observablehq/client.js";
import {registerFile} from "./_observablehq/stdlib.js";

registerFile("./data/likelihood.json", {"name":"./data/likelihood.json","mimeType":"application/json","path":"./_file/data/likelihood.f7a967d7.json"});

define({id: "5a710d61", inputs: ["FileAttachment"], outputs: ["html","file"], body: async (FileAttachment) => {
const {html} = await import("./_npm/htl@0.3.1/+esm.js");
const file = FileAttachment("data/likelihood.json").json();
return {html,file};
}});

define({id: "618b2d82", inputs: ["view","Inputs","aq","file"], outputs: ["parsample","table","datatable","a","b"], body: (view,Inputs,aq,file) => {
// parsample = Math.floor(Math.random()*10);
const parsample = view(Inputs.button("Sample Dataset", {value: 1, reduce: () => 1+Math.floor(Math.random()*10)}));
const table = aq.from(file.likelihood);
const datatable = aq.from(file.data);
const a = view(Inputs.range([0, 10], {step: 0.5, label:'Intercept (α)'}));
const b = view(Inputs.range([0, 1], {step: .05, label: "Slope (β)"}));
return {parsample,table,datatable,a,b};
}});

define({id: "58fb4bd1", inputs: ["table","aq","b","a"], outputs: ["tv"], body: (table,aq,b,a) => {
const tv = table.filter(aq.escape(d => (Math.abs(d.b-b) < 0.00001) && (Math.abs(d.a - a) <  0.0001)));
return {tv};
}});

define({id: "d4103d18", inputs: ["table","aq"], outputs: ["minmax"], body: (table,aq) => {
const minmax = table.rollup({minll: aq.op.min("ll"), maxll: aq.op.max("ll")}).objects()[0];
return {minmax};
}});

define({id: "f574b62f", inputs: ["datatable","aq","parsample","b","a"], outputs: ["dp","dp2"], body: (datatable,aq,parsample,b,a) => {
const dp = datatable.filter(aq.escape(d => d.parset == parsample));
const dp2 = dp.filter(aq.escape(d => (Math.abs(d.b-b) < 0.00001) && (Math.abs(d.a - a) <  0.0001)))
return {dp,dp2};
}});

define({id: "92fa335b", inputs: ["dp","aq"], outputs: ["llvals"], body: (dp,aq) => {
const llvals = dp.rollup({minll: aq.op.min("ll"), maxll: aq.op.max("ll")}).objects()[0]
return {llvals};
}});

define({id: "f2b8c9f9", inputs: ["dp","aq","a","b"], outputs: ["allvals","bvals","avals"], body: (dp,aq,a,b) => {
const allvals  = dp.groupby('a','b').rollup({ll: aq.op.sum("ll")})

const bvals  = dp.groupby('a','b').rollup({ll: aq.op.sum("ll")}).filter(aq.escape(d => Math.abs(a-d.a) < 0.0001 )).objects();

const avals  = dp.groupby('a','b').rollup({ll: aq.op.sum("ll")}).filter(aq.escape(d => Math.abs(b-d.b) < 0.0001 )).objects();

return {allvals,bvals,avals};
}});

define({id: "59cac8c8", inputs: ["Plot","a","b","dp2","display"], body: async (Plot,a,b,dp2,display) => {
display(await(
Plot.plot({
 x: {domain:[0,9]},
 y: {domain:[0,9]},
  color: {label: "Density", legend: true, scheme:"turbo", type:"symlog"},
  marks: [

  // Plot.raster(tv.array("ll"), {x1: 0, x2: 10, y1: 0, y2: 10, width: 41, height: 41}),
    Plot.link([1], {
      x1: 0,
      y1: a,
      x2: 10,
      y2: (k) => a + (b*10),
      strokeOpacity: (k) => k === 1 ? 1 : 0.2
    }),
        Plot.dot(dp2, {x:"x", y:"y", stroke: (k) => Math.exp(-k.ll), r: (k) => Math.exp(-k.ll), strokeOpacity:1})
  ] 
})
))
}});

define({id: "b90c7f3e", inputs: ["Plot","allvals","b","a","display"], body: async (Plot,allvals,b,a,display) => {
display(await(
Plot.plot({
  color: {label: "Negative Log-Likelihood", type: "symlog",  legend: true},
  marks: [
  Plot.raster(allvals.array("ll"), {y1: 0, y2:10, x1:0, x2:1, width: 21, height:21}),
  Plot.ruleX([b]),
  Plot.ruleY([a])
  ]
})
))
}});

define({id: "e9760447", inputs: ["Plot","bvals","b","display"], body: async (Plot,bvals,b,display) => {
display(await(
Plot.plot({
  marks: [
    Plot.line(bvals, {x:"b", y:"ll"}),
    Plot.ruleX([b])
  ]
    })
))
}});

define({id: "5edd5c14", inputs: ["Plot","avals","a","display"], body: async (Plot,avals,a,display) => {
display(await(
Plot.plot({
 // y: {domain: [-4000, 0]},
  marks: [
    Plot.line(avals, {x:"a", y:"ll"}),
    Plot.ruleX([a])
  ]
    })
))
}});

</script>
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type), h2:first-child, :not(h1) + h2">
<nav>
</nav>
</aside>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<div id="cell-5a710d61" class="observablehq observablehq--block"></div>
<div id="cell-618b2d82" class="observablehq observablehq--block"></div>
<div id="cell-58fb4bd1" class="observablehq observablehq--block"></div>
<div id="cell-d4103d18" class="observablehq observablehq--block"></div>
<div id="cell-f574b62f" class="observablehq observablehq--block"></div>
<div id="cell-92fa335b" class="observablehq observablehq--block"></div>
<div id="cell-f2b8c9f9" class="observablehq observablehq--block"></div>
<div class="grid grid-cols-2">
<div id="cell-59cac8c8" class="observablehq observablehq--block observablehq--loading"></div>
<div id="cell-b90c7f3e" class="observablehq observablehq--block observablehq--loading"></div>
</div>
<div class="grid grid-cols-2">
<div id="cell-e9760447" class="observablehq observablehq--block observablehq--loading"></div>
<div id="cell-5edd5c14" class="observablehq observablehq--block observablehq--loading"></div>
</div></main>
<footer id="observablehq-footer">
<div>Built with <a href="https://observablehq.com/" target="_blank">Observable</a> on <a title="2024-03-07T09:14:52">Mar 7, 2024</a>.</div>
</footer>
</div>
