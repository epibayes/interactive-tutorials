<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Likelihood &amp; Model Fit | Bayes</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-deep-space.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-deep-space.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/+esm.js">
<link rel="modulepreload" href="./_npm/arquero@5.4.0/+esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.13/+esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/+esm.js">
<link rel="modulepreload" href="./_npm/apache-arrow@14.0.2/+esm.js">
<link rel="modulepreload" href="./_npm/acorn@8.11.2/+esm.js">
<link rel="modulepreload" href="./_npm/d3@7.8.5/+esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/+esm.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/+esm.js">
<script type="module">

import {define} from "./_observablehq/client.js";
import {registerFile} from "./_observablehq/stdlib.js";

registerFile("./data/likelihood.json", {"name":"./data/likelihood.json","mimeType":"application/json","path":"./_file/data/likelihood.f7a967d7.json"});

define({id: "5a710d61", inputs: ["FileAttachment"], outputs: ["html","file"], body: async (FileAttachment) => {
const {html} = await import("./_npm/htl@0.3.1/+esm.js");
const file = FileAttachment("data/likelihood.json").json();
return {html,file};
}});

define({id: "2e7e113e", inputs: ["view","Inputs","aq","file"], outputs: ["parsample","table","datatable"], body: (view,Inputs,aq,file) => {
// parsample = Math.floor(Math.random()*10);
const parsample = view(Inputs.button("Sample Dataset", {value: 1, reduce: () => 1+Math.floor(Math.random()*10)}));
const table = aq.from(file.likelihood);
const datatable = aq.from(file.data);

return {parsample,table,datatable};
}});

define({id: "d522e0b4", inputs: ["Inputs"], outputs: ["i"], body: (Inputs) => {
const i = Inputs.input(1)
return {i};
}});

define({id: "9a274df9", inputs: ["Inputs","view","table","aq"], outputs: ["zz","yy","a","b","tv"], body: (Inputs,view,table,aq) => {
const zz = Inputs.range([0, 10], {step: 0.5, label:'Intercept (α)'})
const yy = Inputs.range([0, 1], {step: .05, label: "Slope (β)"})
const a = view(zz);
const b = view(yy);

const tv = table.filter(aq.escape(d => (Math.abs(d.b-b) < 0.00001) && (Math.abs(d.a - a) <  0.0001)));
return {zz,yy,a,b,tv};
}});

define({id: "6e16ea1f", inputs: ["table","aq"], outputs: ["minmax"], body: (table,aq) => {
const minmax = table.rollup({minll: aq.op.min("ll"), maxll: aq.op.max("ll")}).objects()[0];

return {minmax};
}});

define({id: "f574b62f", inputs: ["datatable","aq","parsample","b","a"], outputs: ["dp","dp2"], body: (datatable,aq,parsample,b,a) => {
const dp = datatable.filter(aq.escape(d => d.parset == parsample));
const dp2 = dp.filter(aq.escape(d => (Math.abs(d.b-b) < 0.00001) && (Math.abs(d.a - a) <  0.0001)))
return {dp,dp2};
}});

define({id: "92fa335b", inputs: ["dp","aq"], outputs: ["llvals"], body: (dp,aq) => {
const llvals = dp.rollup({minll: aq.op.min("ll"), maxll: aq.op.max("ll")}).objects()[0]
return {llvals};
}});

define({id: "f2b8c9f9", inputs: ["dp","aq","a","b"], outputs: ["allvals","bvals","avals"], body: (dp,aq,a,b) => {
const allvals  = dp.groupby('a','b').rollup({ll: aq.op.sum("ll")})

const bvals  = dp.groupby('a','b').rollup({ll: aq.op.sum("ll")}).filter(aq.escape(d => Math.abs(a-d.a) < 0.0001 )).objects();

const avals  = dp.groupby('a','b').rollup({ll: aq.op.sum("ll")}).filter(aq.escape(d => Math.abs(b-d.b) < 0.0001 )).objects();

return {allvals,bvals,avals};
}});

define({id: "4f06073e", inputs: ["Plot","a","b","dp2","display"], body: async (Plot,a,b,dp2,display) => {
display(await(
Plot.plot({
 x: {domain:[0,9]},
 y: {domain:[0,9]},
  color: {label: "Density", legend: true, scheme:"turbo", type:"symlog"},
  marks: [

  // Plot.raster(tv.array("ll"), {x1: 0, x2: 10, y1: 0, y2: 10, width: 41, height: 41}),
    Plot.link([1], {
      x1: 0,
      y1: a,
      x2: 10,
      y2: (k) => a + (b*10),
      strokeOpacity: (k) => k === 1 ? 1 : 0.2
    }),
      Plot.dot(dp2, {x:"x", y:"y", stroke: (k) => Math.exp(-k.ll), r: (k) => Math.exp(-k.ll), strokeOpacity:1})
  ],

  width: 600
})

))
}});

define({id: "b90c7f3e", inputs: ["Plot","allvals","b","a","display"], body: async (Plot,allvals,b,a,display) => {
display(await(
Plot.plot({
  color: {label: "Negative Log-Likelihood", type: "symlog",  legend: true},
  marks: [
  Plot.raster(allvals.array("ll"), {y1: 0, y2:10, x1:0, x2:1, width: 21, height:21}),
  Plot.ruleX([b]),
  Plot.ruleY([a])
  ]
})
))
}});

define({id: "e9760447", inputs: ["Plot","bvals","b","display"], body: async (Plot,bvals,b,display) => {
display(await(
Plot.plot({
  marks: [
    Plot.line(bvals, {x:"b", y:"ll"}),
    Plot.ruleX([b])
  ]
    })
))
}});

define({id: "34e76d59", inputs: ["view","Inputs","yy"], outputs: ["bb"], body: (view,Inputs,yy) => {
const bb = view(Inputs.bind(Inputs.range([0, 1], {step: .05, label: "Slope (β)"}),yy))
return {bb};
}});

define({id: "5edd5c14", inputs: ["Plot","avals","a","display"], body: async (Plot,avals,a,display) => {
display(await(
Plot.plot({
 // y: {domain: [-4000, 0]},
  marks: [
    Plot.line(avals, {x:"a", y:"ll"}),
    Plot.ruleX([a])
  ]
    })
))
}});

define({id: "821568a6", inputs: ["view","Inputs","zz"], outputs: ["aa"], body: (view,Inputs,zz) => {
    const aa = view(Inputs.bind(Inputs.range([0, 10], {step: 0.5, label:'α'}),zz));
return {aa};
}});

define({id: "75a11da4", body: () => {

}});

</script>
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type), h2:first-child, :not(h1) + h2">
<nav>
<div>Contents</div>
<ol>
<li class="observablehq-secondary-link"><a href="#likelihood-in-two-dimensions">Likelihood in two dimensions</a></li>
</ol>
</nav>
</aside>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<h1 id="exploring-the-relationship-between-likelihood-and-model-fit" tabindex="-1"><a class="observablehq-header-anchor" href="#exploring-the-relationship-between-likelihood-and-model-fit">Exploring the relationship between likelihood and model fit</a></h1>
<div id="cell-5a710d61" class="observablehq observablehq--block"></div>
<div id="cell-2e7e113e" class="observablehq observablehq--block"></div>
<div class="grid grid-cols-2" ,="" style="grid-auto-rows: auto; max-width:800px;">
<div class="card grid-colspan-2">
<h2> Some example data </h2>
<h3> Try moving the sliders for the slope (β) and intercept (α) to optimize the fit to the data. </h3>
<div id="cell-d522e0b4" class="observablehq observablehq--block"></div>
<div id="cell-9a274df9" class="observablehq observablehq--block"></div>
<div id="cell-6e16ea1f" class="observablehq observablehq--block"></div>
<div id="cell-f574b62f" class="observablehq observablehq--block"></div>
<div id="cell-92fa335b" class="observablehq observablehq--block"></div>
<div id="cell-f2b8c9f9" class="observablehq observablehq--block"></div>
<div id="cell-4f06073e" class="observablehq observablehq--block observablehq--loading"></div>
<p> In this example, the size and color of the dots indicates the probability density of each example data point. Try different values and see what happens to the relative likelihood of each point. </p>
</div>
</div>
<h2 id="likelihood-in-two-dimensions" tabindex="-1"><a class="observablehq-header-anchor" href="#likelihood-in-two-dimensions">Likelihood in two dimensions</a></h2>
<div class="grid grid-cols-2" ,="" style="grid-auto-rows: auto; max-width:800px;">
<div class="card grid-colspan-2">
<div id="cell-b90c7f3e" class="observablehq observablehq--block observablehq--loading"></div>
</div>
<div class="card grid-colspan-1">
<h2> Slope </h2>
<div id="cell-e9760447" class="observablehq observablehq--block observablehq--loading"></div>
<div id="cell-34e76d59" class="observablehq observablehq--block"></div>
</div>
<div class="card grid-colspan-1">
<h2> Intercept </h2>
<div id="cell-5edd5c14" class="observablehq observablehq--block observablehq--loading"></div>
<div id="cell-821568a6" class="observablehq observablehq--block"></div>
</div>
</div>
<div id="cell-75a11da4" class="observablehq observablehq--block"></div>
</main>
<footer id="observablehq-footer">
<div>Built with <a href="https://observablehq.com/" target="_blank">Observable</a> on <a title="2024-03-07T17:23:17">Mar 7, 2024</a>.</div>
</footer>
</div>
